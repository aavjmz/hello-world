# CAN Analyzer - 主界面UI说明文档

## 界面总览

### 窗口属性
- **标题**: CAN Analyzer - CAN Bus Message Analysis Tool
- **尺寸**: 1400 x 800 像素
- **布局**: 左右分栏（可调整大小）

---

## 1. 菜单栏

### 文件菜单 (F)
```
文件(F)
├─ 导入报文(I)... [Ctrl+I]
│  └─ 导入ASC或BLF格式的CAN报文文件
├─ ───────────────
└─ 退出(X) [Ctrl+Q]
   └─ 退出应用程序
```

### DBC菜单 (D)
```
DBC(D)
├─ 导入DBC(I)...
│  └─ 导入DBC数据库文件
└─ 管理DBC(M)...
   └─ 管理已加载的DBC文件
```

### 视图菜单 (V)
```
视图(V)
└─ 新建视图(N) [Ctrl+T]
   └─ 创建新的信号曲线视图
```

### 工具菜单 (T)
```
工具(T)
└─ 过滤器(F)...
   └─ 配置报文过滤器
```

### 帮助菜单 (H)
```
帮助(H)
└─ 关于(A)
   └─ 关于CAN Analyzer
```

---

## 2. 工具栏

```
┌──────────┬──────────┬──────────┬────────┐
│ 导入报文 │ 导入DBC  │ 新建视图 │  ...   │
└──────────┴──────────┴──────────┴────────┘
```

**工具栏按钮:**
1. **导入报文** - 快速导入CAN报文文件
2. **导入DBC** - 快速导入DBC文件
3. **新建视图** - 快速创建曲线视图

---

## 3. 主工作区 (左右分栏)

### 3.1 左侧：报文列表表格 (30%)

**表格列定义:**

| 列名 | 宽度 | 对齐 | 说明 |
|------|------|------|------|
| 序号 | 自动 | 居中 | 报文序号 (1, 2, 3...) |
| 时间戳 | 自动 | 右对齐 | 可切换格式 (秒/毫秒/微秒) |
| 通道 | 自动 | 居中 | CAN通道号 |
| CAN ID | 自动 | 居中 | 十六进制显示 (0x123) |
| 方向 | 自动 | 居中 | Rx(绿色) / Tx(蓝色) |
| DLC | 自动 | 居中 | 数据长度 (0-8) |
| 数据 | 自动伸展 | 左对齐 | 十六进制数据 (00 01 02...) |

**表格特性:**
- ✓ 隔行变色（便于阅读）
- ✓ 单行选择模式
- ✓ 垂直滚动条（支持大量数据）
- ✓ 水平滚动条（支持长数据）
- ✓ 不可编辑（只读显示）
- ✓ 双击报文触发详情查看

**右键菜单:**
```
┌──────────────────┐
│ 复制             │
├──────────────────┤
│ 时间戳格式 ▶     │
│   ├─ 原始格式    │
│   ├─ 秒          │
│   ├─ 毫秒        │
│   └─ 微秒        │
└──────────────────┘
```

**数据示例:**
```
序号│时间戳      │通道│CAN ID│方向│DLC│数据
────┼────────────┼────┼──────┼────┼───┼─────────────────────
  1 │  0.010000  │ 1  │0x123 │Rx ▼│ 8 │00 01 02 03 04 05 06 07
  2 │  0.020000  │ 1  │0x456 │Tx ▲│ 8 │AA BB CC DD EE FF 00 11
  3 │  0.030000  │ 1  │0x123 │Rx ▼│ 8 │10 11 12 13 14 15 16 17
  4 │  0.040000  │ 2  │0x789 │Rx ▼│ 4 │DE AD BE EF
  5 │  0.050000  │ 1  │0x456 │Tx ▲│ 8 │12 34 56 78 9A BC DE F0
```

---

### 3.2 右侧：视图区域 (70%)

**标签页界面:**
```
┌────────────────────────────────────────┐
│ 视图1 │ 视图2 │ 视图3 │ +          × │
├────────────────────────────────────────┤
│                                        │
│     (视图内容区域)                     │
│                                        │
│     未来将显示：                       │
│     - 信号时间曲线                     │
│     - 多信号叠加显示                   │
│     - 可缩放、平移的交互式图表         │
│                                        │
└────────────────────────────────────────┘
```

**标签页特性:**
- ✓ 多标签页支持
- ✓ 可关闭标签 (X按钮)
- ✓ 新建标签 (+按钮)
- ✓ 独立视图配置

**空白提示信息:**
```
┌────────────────────────────────────────┐
│                                        │
│           📊                           │
│                                        │
│      暂无视图                          │
│                                        │
│   点击"新建视图"按钮创建信号曲线图     │
│                                        │
│   功能特性：                           │
│   • 信号随时间变化曲线                 │
│   • 鼠标滚轮缩放                       │
│   • 拖拽平移                           │
│   • 多信号叠加显示                     │
│                                        │
└────────────────────────────────────────┘
```

---

## 4. 状态栏

```
┌──────────┬────────────┬──────────────┬────────────┐
│ 就绪     │ 报文数: 10 │ 时间范围:... │ 唯一ID: 6  │
└──────────┴────────────┴──────────────┴────────────┘
```

**显示内容:**
- **状态信息**: 当前操作状态
- **报文统计**: 总报文数
- **时间信息**: 时间范围或持续时间
- **ID统计**: 唯一CAN ID数量

**状态示例:**
- `就绪` - 空闲状态
- `正在解析文件: test_data.asc...` - 加载中
- `导入成功! 共10条报文, 时间范围: 0.240s, 唯一ID: 6个` - 成功提示
- `DBC加载成功: test_data (6个报文定义)` - DBC加载

---

## 5. 对话框

### 5.1 导入报文对话框

```
┌─────────────────────────────────────┐
│ 导入CAN报文文件                     │
├─────────────────────────────────────┤
│                                     │
│  选择文件:                          │
│  ┌───────────────────┬──────────┐  │
│  │ test_data.asc    │ 浏览...  │  │
│  └───────────────────┴──────────┘  │
│                                     │
│  文件类型:                          │
│  ┌─────────────────────────────┐   │
│  │ CAN文件 (*.asc *.blf *.log) │   │
│  │ ASC文件 (*.asc)             │   │
│  │ BLF文件 (*.blf)             │   │
│  │ 所有文件 (*.*)              │   │
│  └─────────────────────────────┘   │
│                                     │
│           ┌────────┬────────┐       │
│           │  打开  │  取消  │       │
│           └────────┴────────┘       │
└─────────────────────────────────────┘
```

### 5.2 导入成功对话框

```
┌─────────────────────────────────────┐
│ ℹ 导入成功                          │
├─────────────────────────────────────┤
│                                     │
│  文件: test_data.asc                │
│                                     │
│  总报文数: 10                       │
│  时间范围: 0.010000s - 0.250000s    │
│  持续时间: 0.240s                   │
│  唯一CAN ID数: 6                    │
│  接收报文: 7                        │
│  发送报文: 3                        │
│                                     │
│           ┌────────┐                │
│           │  确定  │                │
│           └────────┘                │
└─────────────────────────────────────┘
```

### 5.3 DBC导入成功对话框

```
┌─────────────────────────────────────┐
│ ℹ DBC导入成功                       │
├─────────────────────────────────────┤
│                                     │
│  数据库名称: test_data              │
│  文件路径: /path/to/test_data.dbc   │
│  报文定义数: 6                      │
│  节点数: 3                          │
│                                     │
│           ┌────────┐                │
│           │  确定  │                │
│           └────────┘                │
└─────────────────────────────────────┘
```

### 5.4 关于对话框

```
┌─────────────────────────────────────┐
│ ℹ 关于 CAN Analyzer                 │
├─────────────────────────────────────┤
│                                     │
│    CAN Analyzer v0.1.0              │
│                                     │
│  CAN总线报文分析工具                │
│                                     │
│  功能特性：                         │
│  • 支持ASC、BLF格式报文解析         │
│  • DBC文件管理（增删改查）          │
│  • 信号曲线可视化                   │
│  • 支持曲线缩放和平移               │
│                                     │
│           ┌────────┐                │
│           │  确定  │                │
│           └────────┘                │
└─────────────────────────────────────┘
```

---

## 6. 颜色方案

### 表格颜色
- **背景**: 白色 / 浅灰色（隔行）
- **选中行**: 浅蓝色
- **Rx方向**: 绿色文字 (RGB: 0, 128, 0)
- **Tx方向**: 蓝色文字 (RGB: 0, 0, 255)

### 界面颜色
- **主背景**: 系统默认
- **工具栏**: 浅灰色
- **状态栏**: 浅灰色
- **分隔线**: 灰色

---

## 7. 交互流程

### 7.1 导入报文流程
```
用户操作                    系统响应
───────────────────────    ──────────────────────────
1. 点击"导入报文"          → 打开文件选择对话框
2. 选择文件                → 文件路径显示
3. 点击"打开"              → 状态栏:"正在解析..."
4. 解析中...               → 进度反馈
5. 解析完成                → 弹出"导入成功"对话框
6. 点击"确定"              → 表格显示报文数据
                           → 状态栏更新统计信息
```

### 7.2 时间戳格式切换流程
```
用户操作                    系统响应
───────────────────────    ──────────────────────────
1. 右键点击表格            → 显示上下文菜单
2. 选择"时间戳格式"        → 显示子菜单
3. 选择"毫秒"              → 表格刷新
                           → 时间戳列变为"10.000ms"格式
```

---

## 8. 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+I | 导入报文 |
| Ctrl+T | 新建视图 |
| Ctrl+Q | 退出程序 |
| Ctrl+C | 复制选中行 |
| ↑/↓    | 上下选择报文 |
| Home   | 跳到第一条报文 |
| End    | 跳到最后一条报文 |

---

## 9. 窗口尺寸适配

### 最小尺寸
- **宽度**: 800px
- **高度**: 600px

### 推荐尺寸
- **宽度**: 1400px
- **高度**: 800px

### 分栏调整
- 用户可拖动分隔线调整左右比例
- 默认比例: 30% : 70%
- 可调范围: 20%-50% : 50%-80%

---

## 10. 响应式行为

### 表格行为
- **滚动**: 自动显示滚动条
- **列宽**: 自适应内容
- **选择**: 高亮显示
- **双击**: 触发详情查看

### 窗口行为
- **最大化**: 布局自动调整
- **最小化**: 隐藏到任务栏
- **关闭**: 提示保存（如有未保存数据）

---

## 使用示例

### 示例1: 查看10条CAN报文

```
操作步骤:
1. 启动程序
2. 点击"文件" → "导入报文"
3. 选择 test_data.asc
4. 查看表格中显示的10条报文
5. 状态栏显示: "报文数: 10, 时间范围: 0.240s"
```

### 示例2: 使用DBC解析

```
操作步骤:
1. 先导入报文 (如示例1)
2. 点击"DBC" → "导入DBC"
3. 选择 test_data.dbc
4. 弹窗显示: "6个报文定义, 3个节点"
5. (未来功能) 表格显示解析后的信号值
```

### 示例3: 切换时间戳格式

```
操作步骤:
1. 在报文表格上右键
2. 选择"时间戳格式" → "毫秒"
3. 时间戳列从"0.010000"变为"10.000ms"
```

---

**最后更新**: 2021-11-01
**UI版本**: 0.1.0
**兼容性**: PyQt6 6.6.0+
